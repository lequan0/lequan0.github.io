---
title: "Lab14"
author: "quan le"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

load("data/digits.RData")
dat38 = rbind(digits[which(rownames(digits)==3),],digits[which(rownames(digits)==8),])
```

# Independent component analysis (ICA)

```{r, echo = TRUE}
library(fastICA)
require("fastICA")

K = c(10, 15, 20)
for (k in K) {
  icafit = fastICA(t(dat38),n.comp=k)

  #plot independent source signals 
  options(width = 60)
  par(mfrow=c(k/5, 5), mar = c(1, 1, 1, 1), pty="s")
  for(i in 1:k){
    imagedigit(icafit$S[,i])
  }
}
```

# Non-negative matrix factorization (NMF)

```{r}
#Note that this may take a while to run - try using smaller values of K
library(NMF)
K = c(3, 6, 9)
for (k in K) {
  nmffit = nmf(dat38+1,rank=k) 
  W = basis(nmffit)
  H = coef(nmffit)
  
  #plot NMF basis factors
  options(width = 60)
  par(mfrow=c(k/3,3),mar = c(1, 1, 1, 1), pty="s")
  for(i in 1:k){
    imagedigit(H[i,])
  }
}
```




