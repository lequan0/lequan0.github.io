"0","#Note that this may take a while to run - try using smaller values of K"
"0","library(NMF)"
"0","K = c(3, 6, 9)"
"0","for (k in K) {"
"0","  nmffit = nmf(dat38+1,rank=k) "
"0","  W = basis(nmffit)"
"0","  H = coef(nmffit)"
"0","  "
"0","  #plot NMF basis factors"
"0","  options(height = 20 * k / 3, width = 60)"
"0","  par(mfrow=c(k/3,3),mar = c(1, 1, 1, 1), pty=""s"")"
"0","  for(i in 1:k){"
"0","    imagedigit(H[i,])"
"0","  }"
"0","}"
